# Local development Caddyfile (HTTPS on port 9999)
# Add these to your /etc/hosts:
# 127.0.0.1 sathub.local
# 127.0.0.1 api.sathub.local
# 127.0.0.1 obj.sathub.local

# Frontend
sathub.local:9999 {
    reverse_proxy frontend:5173
}

# API
api.sathub.local:9999 {
    # Handle OPTIONS requests for CORS
    @options {
        method OPTIONS
    }
    respond @options 204

    reverse_proxy backend:4001

    # CORS headers for API
    header Access-Control-Allow-Origin *
    header Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
    header Access-Control-Allow-Headers "Authorization, Content-Type, X-Amz-Date, X-Amz-Security-Token, X-Amz-User-Agent"
    header Access-Control-Allow-Credentials false
}

# Object storage (MinIO)
obj.sathub.local:9999 {
    reverse_proxy minio:9000
}