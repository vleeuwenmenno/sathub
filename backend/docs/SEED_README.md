# Database Seeding Script

This script populates the database with test data for development and testing purposes.

## What it creates

The seed script creates:

### Users (3 test users)

- `alice_skywatcher` - password: `password123`
- `bob_satellite` - password: `password123`
- `charlie_space` - password: `password123`

### Stations (6 stations total)

- **Alice's stations**: 2 stations (1 public, 1 private)
- **Bob's stations**: 2 stations (both public)
- **Charlie's stations**: 2 stations (1 public, 1 private)

### Posts (15-40 posts total)

- Each station gets 3-8 random posts
- Posts include random satellite names, timestamps, and metadata
- Timestamps are spread over the last 30 days

### Images (1-3 images per post)

- Each post gets 1-3 placeholder images
- Images are stored as BLOBs in the database

## Running the seed script

### Prerequisites

- Go 1.21+ installed
- Backend dependencies installed (`go mod download`)
- Database connection configured (PostgreSQL by default, SQLite if DB_TYPE=sqlite)

### Method 1: Direct execution

```bash
cd backend
go run seed.go
# Creates database at ./satdump.db (or path specified by DB_PATH env var)
```

### Method 2: Build and run

```bash
cd backend
go build -o seed seed.go
./seed
# Creates database at ./satdump.db (or path specified by DB_PATH env var)
```

### Method 3: Using the shell script

```bash
cd backend
chmod +x seed.sh
./seed.sh
# Creates database at ./satdump.db (or path specified by DB_PATH env var)
```

## Sample data details

### Satellite names used

- NOAA 15, 18, 19
- METEOR-M2 series
- Fengyun 3C/D
- Terra, Aqua, Suomi NPP
- Sentinel-1A/B
- And more...

### Locations in metadata

- Various global regions (continents, oceans, hemispheres)
- Random frequencies in the 137-147 MHz range
- APT mode (common for weather satellites)

## Cleaning up test data

To remove all seeded data:

```sql
-- Delete in correct order due to foreign keys
DELETE FROM post_images;
DELETE FROM posts;
DELETE FROM stations;
DELETE FROM users WHERE username IN ('alice_skywatcher', 'bob_satellite', 'charlie_space');
```

Or simply drop and recreate the database.

## Database Path

The seed script will create a database file at:

- `./satdump.db` (default when running locally)
- Path specified by `DB_PATH` environment variable
- When running in Docker: uses the mounted volume path (typically `../data/satdump.db`)

## Notes

- The script uses random data generation, so results will vary between runs
- All passwords are set to `password123` for easy testing
- Station tokens are auto-generated by the model hooks
- Images are placeholder data (not real images) to avoid file system dependencies
- The script is idempotent - you can run it multiple times (though it will create duplicate data)

## Testing the seeded data

After seeding, you can:

1. **Login** with any of the test users (alice/bob/charlie, password: password123)
2. **View stations** - Check both your stations and global stations
3. **Browse posts** - Homepage shows recent posts, click stations to see their posts
4. **Test pagination** - Stations with many posts will show pagination
5. **Test permissions** - Private stations only visible to owners

The seeded data provides a realistic testing environment for the full application workflow!
